% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weight_pred_functions.R
\name{distance_from_benchmark_l1_metric}
\alias{distance_from_benchmark_l1_metric}
\title{Custom L1 Distance from Benchmark Metric for Keras}
\usage{
distance_from_benchmark_l1_metric()
}
\value{
A scalar L1 distance value for the current batch of data.
}
\description{
This function calculates the L1 distance between the portfolio weights and the benchmark weights,
effectively measuring how much the portfolio has deviated from the benchmark in terms of absolute adjustments.
}
\examples{
\dontrun{
# Define test data: 3 stocks over 2 dates
test_data <- data.frame(
  stock_id = c(1, 1, 2, 2, 3, 3),
  date = c(1, 2, 1, 2, 1, 2),
  benchmark = c(0.4, 0.4, 0.3, 0.3, 0.3, 0.3),  # Benchmark weights
  actual_return = c(0.01, 0.02, -0.01, 0.01, 0.03, -0.02)  # Actual returns
)

# Predicted weight adjustments (delta_w)
predicted_weight_changes <- c(0.05, 0.06, -0.01, -0.02, -0.01, -0.01)

# Convert to TensorFlow tensors
y_true_test <- tf$constant(as.matrix(test_data), dtype = "float32")
y_pred_test <- tf$constant(predicted_weight_changes, dtype = "float32")

# Define the custom L1 distance metric
l1_metric <- distance_from_benchmark_l1_metric()

# Compute the metric value
metric_value <- l1_metric(y_true_test, y_pred_test)

# Print the metric value
print(metric_value)
}
}
