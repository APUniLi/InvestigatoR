% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weight_pred_functions.R
\name{information_ratio_loss_regression_based}
\alias{information_ratio_loss_regression_based}
\title{Custom Regression-Based Information Ratio Loss Function with L1/L2 Regularization for Keras}
\usage{
information_ratio_loss_regression_based(lambda_l1 = 0.01, lambda_l2 = 0.01)
}
\arguments{
\item{lambda_l1}{Numeric. L1 regularization coefficient (default: 0.01).}

\item{lambda_l2}{Numeric. L2 regularization coefficient (default: 0.01).}
}
\value{
A scalar loss value that combines the negative Information Ratio with L1/L2 regularization.
}
\description{
This function calculates a custom loss for portfolio optimization using Keras,
aiming to maximize the Information Ratio (IR) based on regression alpha and idiosyncratic
return standard deviation relative to a benchmark (e.g., S&P 500). It includes L1 and L2
regularization penalties to control the magnitude and sparsity of portfolio weight adjustments.
}
\examples{
\dontrun{
# Example: simple portfolio with 3 stocks and 2 dates
example_data <- data.frame(
  stock_id = c(1, 1, 2, 2, 3, 3),
  date = c(1, 2, 1, 2, 1, 2),
  benchmark = c(0.4, 0.4, 0.3, 0.3, 0.3, 0.3),  # Benchmark weights
  actual_return = c(0.01, 0.02, -0.01, 0.01, 0.03, -0.02)  # Actual stock returns
)

# Sample predicted weight adjustments (delta_w) for each stock and date
predicted_weight_changes <- c(0.05, 0.06, -0.01, -0.02, -0.01, -0.01)

# Convert data to TensorFlow tensors
y_true <- tf$constant(as.matrix(example_data), dtype = "float32")
y_pred <- tf$constant(predicted_weight_changes, dtype = "float32")

# Call the custom loss function
loss_value <- information_ratio_loss_regression_based(
  lambda_l1 = 0.01,
  lambda_l2 = 0.01
)(y_true, y_pred)

# Print the calculated loss value
print(loss_value)
}
}
